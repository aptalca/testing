{"version":3,"sources":["webpack:///./src/views/PlexMedia.vue?0469","webpack:///src/views/PlexMedia.vue","webpack:///./src/views/PlexMedia.vue?ad93","webpack:///./src/views/PlexMedia.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","metadata","type","attrs","staticStyle","staticClass","staticRenderFns","name","components","PlexItem","PlexSeason","PlexSeries","props","machineIdentifier","String","required","ratingKey","Number","data","abortController","computed","watch","combinedKey","fetchMetadata","immediate","abortRequests","methods","abort","signal","FETCH_PLEX_METADATA","SET_ACTIVE_METADATA","SET_MEDIA_AS_BACKGROUND","controller","AbortController","fetchMetadataCriticalSection","aborted","e","component","VCol","VProgressCircular","VRow"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAQF,EAAY,SAAEI,EAAG,MAAM,CAAwB,WAAtBJ,EAAIM,SAASC,MAA2C,SAAtBP,EAAIM,SAASC,KAAiBH,EAAG,aAAa,CAACI,MAAM,CAAC,SAAWR,EAAIM,YAAmC,WAAtBN,EAAIM,SAASC,KAAmBH,EAAG,aAAa,CAACI,MAAM,CAAC,SAAWR,EAAIM,YAAYF,EAAG,WAAW,CAACI,MAAM,CAAC,SAAWR,EAAIM,aAAa,GAAGF,EAAG,QAAQ,CAACA,EAAG,QAAQ,CAACK,YAAY,CAAC,SAAW,YAAYD,MAAM,CAAC,KAAO,OAAO,CAACJ,EAAG,sBAAsB,CAACM,YAAY,cAAcD,YAAY,CAAC,KAAO,MAAM,IAAM,OAAOD,MAAM,CAAC,KAAO,GAAG,cAAgB,OAAO,IAAI,IAC3kBG,EAAkB,G,YCqCtB,GACEC,KAAM,YAENC,WAAY,CACVC,SAAU,IAAM,QAApB,6EACIC,WAAY,IAAM,EAAtB,8CACIC,WAAY,IAAM,EAAtB,+CAGEC,MAAO,CACLC,kBAAmB,CACjBX,KAAMY,OACNC,UAAU,GAGZC,UAAW,CACTd,KAAM,CAACe,OAAQH,QACfC,UAAU,IAIdG,KAAM,KAAM,CACVjB,SAAU,KACVkB,gBAAiB,OAGnBC,SAAU,IACZ,8BACA,wBAII,cACE,MAAO,CACLP,kBAAmBjB,KAAKiB,kBACxBG,UAAWpB,KAAKoB,aAKtBK,MAAO,CACLC,YAAa,CACX,UACE,OAAO1B,KAAK2B,iBAEdC,WAAW,IAIf,gBACE5B,KAAK6B,iBAGPC,QAAS,IACX,8BACA,0BACA,2BAGO,OAAP,OAAO,CAAP,CACA,wBAGI,gBACM9B,KAAKuB,kBAEPvB,KAAKuB,gBAAgBQ,QACrB/B,KAAKuB,gBAAkB,OAI3B,mCAAmCS,GACjChC,KAAKK,eAAiBL,KAAKiC,oBAAoB,CAC7Cb,UAAWpB,KAAKoB,UAChBH,kBAAmBjB,KAAKiB,kBACxBe,WAGFhC,KAAKkC,oBAAoBlC,KAAKK,gBAExBL,KAAKmC,wBAAwB,CACjClB,kBAAmBjB,KAAKiB,qBACrBjB,KAAKK,YAIZ,sBACEL,KAAK6B,gBAEL,MAAMO,EAAa,IAAIC,gBACvBrC,KAAKuB,gBAAkBa,EAEvB,UACQpC,KAAKsC,6BAA6BF,EAAWJ,QAC3D,SACQ,IAAKI,EAAWJ,OAAOO,QACrB,MAAMC,MCtImU,I,qECO/UC,EAAY,eACd,EACA3C,EACAY,GACA,EACA,KACA,KACA,MAIa,aAAA+B,EAAiB,QAOhC,IAAkBA,EAAW,CAACC,OAAA,KAAKC,oBAAA,KAAkBC,OAAA","file":"js/chunk-2d0ba926.40cc4906.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.metadata)?_c('div',[(_vm.metadata.type === 'series' || _vm.metadata.type === 'show')?_c('PlexSeries',{attrs:{\"metadata\":_vm.metadata}}):(_vm.metadata.type === 'season')?_c('PlexSeason',{attrs:{\"metadata\":_vm.metadata}}):_c('PlexItem',{attrs:{\"metadata\":_vm.metadata}})],1):_c('v-row',[_c('v-col',{staticStyle:{\"position\":\"relative\"},attrs:{\"cols\":\"12\"}},[_c('v-progress-circular',{staticClass:\"amber--text\",staticStyle:{\"left\":\"50%\",\"top\":\"50%\"},attrs:{\"size\":60,\"indeterminate\":\"\"}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div v-if=\"metadata\">\n    <PlexSeries\n      v-if=\"metadata.type === 'series' || metadata.type === 'show'\"\n      :metadata=\"metadata\"\n    />\n\n    <PlexSeason\n      v-else-if=\"metadata.type === 'season'\"\n      :metadata=\"metadata\"\n    />\n\n    <PlexItem\n      v-else\n      :metadata=\"metadata\"\n    />\n  </div>\n\n  <v-row\n    v-else\n  >\n    <v-col\n      cols=\"12\"\n      style=\"position: relative;\"\n    >\n      <v-progress-circular\n        style=\"left: 50%; top: 50%;\"\n        :size=\"60\"\n        indeterminate\n        class=\"amber--text\"\n      />\n    </v-col>\n  </v-row>\n</template>\n\n<script>\nimport { mapActions, mapGetters, mapMutations } from 'vuex';\n\nexport default {\n  name: 'PlexMedia',\n\n  components: {\n    PlexItem: () => import('@/components/PlexItem.vue'),\n    PlexSeason: () => import('@/components/PlexSeason.vue'),\n    PlexSeries: () => import('@/components/PlexSeries.vue'),\n  },\n\n  props: {\n    machineIdentifier: {\n      type: String,\n      required: true,\n    },\n\n    ratingKey: {\n      type: [Number, String],\n      required: true,\n    },\n  },\n\n  data: () => ({\n    metadata: null,\n    abortController: null,\n  }),\n\n  computed: {\n    ...mapGetters('plexservers', [\n      'GET_MEDIA_IMAGE_URL',\n    ]),\n\n    // This exists so we can watch if either of these change\n    combinedKey() {\n      return {\n        machineIdentifier: this.machineIdentifier,\n        ratingKey: this.ratingKey,\n      };\n    },\n  },\n\n  watch: {\n    combinedKey: {\n      handler() {\n        return this.fetchMetadata();\n      },\n      immediate: true,\n    },\n  },\n\n  beforeDestroy() {\n    this.abortRequests();\n  },\n\n  methods: {\n    ...mapActions('plexservers', [\n      'SET_MEDIA_AS_BACKGROUND',\n      'FETCH_PLEX_METADATA',\n    ]),\n\n    ...mapMutations([\n      'SET_ACTIVE_METADATA',\n    ]),\n\n    abortRequests() {\n      if (this.abortController) {\n        // Cancel outstanding request\n        this.abortController.abort();\n        this.abortController = null;\n      }\n    },\n\n    async fetchMetadataCriticalSection(signal) {\n      this.metadata = await this.FETCH_PLEX_METADATA({\n        ratingKey: this.ratingKey,\n        machineIdentifier: this.machineIdentifier,\n        signal,\n      });\n\n      this.SET_ACTIVE_METADATA(this.metadata);\n\n      await this.SET_MEDIA_AS_BACKGROUND({\n        machineIdentifier: this.machineIdentifier,\n        ...this.metadata,\n      });\n    },\n\n    async fetchMetadata() {\n      this.abortRequests();\n\n      const controller = new AbortController();\n      this.abortController = controller;\n\n      try {\n        await this.fetchMetadataCriticalSection(controller.signal);\n      } catch (e) {\n        if (!controller.signal.aborted) {\n          throw e;\n        }\n      }\n    },\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PlexMedia.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PlexMedia.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PlexMedia.vue?vue&type=template&id=897153b8&\"\nimport script from \"./PlexMedia.vue?vue&type=script&lang=js&\"\nexport * from \"./PlexMedia.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VProgressCircular } from 'vuetify/lib/components/VProgressCircular';\nimport { VRow } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VCol,VProgressCircular,VRow})\n"],"sourceRoot":""}