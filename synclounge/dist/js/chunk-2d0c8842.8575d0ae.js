(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c8842"],{"54e2":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",{staticClass:"fill-height"},[i("v-row",{attrs:{align:"center",justify:"center"}},[i("v-col",[i("v-card",{staticClass:"mx-auto",attrs:{"max-width":"550",loading:t.loading}},[t.GET_PLEX_AUTH_TOKEN&&!1===t.IS_USER_AUTHORIZED?i("v-alert",{attrs:{type:"error"}},[t._v(" You are not authorized to access this server ")]):t._e(),i("v-card-title",[i("v-img",{attrs:{contain:"",src:a("336e")}})],1),i("v-card-actions",[i("v-btn",{staticClass:"primary",attrs:{target:"_blank","x-large":"",text:"",disabled:t.allowSignIn,href:t.plexAuthUrl},on:{click:t.authenticate}},[t._v(" Sign in ")])],1)],1)],1)],1)],1)},n=[],s=a("2f62"),l=a("b4ef"),c=a.n(l);const h=t=>{const e="; "+document.cookie,a=e.split(`; ${t}=`);return 2===a.length?a.pop().split(";").shift():null};var r=h,o={name:"SignIn",data:()=>({loading:!1,plexAuthResponse:null,cancelToken:null}),computed:{...Object(s["c"])(["GET_CONFIG"]),...Object(s["c"])("plex",["GET_PLEX_AUTH_URL","IS_USER_AUTHORIZED","GET_PLEX_AUTH_TOKEN"]),plexAuthUrl(){return this.plexAuthResponse?this.GET_PLEX_AUTH_URL(this.plexAuthResponse.code):""},allowSignIn(){return this.loading||!this.plexAuthResponse||!this.IS_USER_AUTHORIZED&&!!this.GET_PLEX_AUTH_TOKEN}},async created(){if(this.IS_USER_AUTHORIZED&&this.GET_PLEX_AUTH_TOKEN)return void this.redirect();const t=r("mpt");t?await this.cookieAuth(t):await this.regularAuth()},beforeDestroy(){this.cancelToken&&(this.cancelToken.abort(),this.cancelToken=null)},methods:{...Object(s["b"])("plex",["FETCH_PLEX_INIT_AUTH","REQUEST_PLEX_AUTH_TOKEN","FETCH_PLEX_DEVICES_IF_NEEDED","FETCH_PLEX_USER"]),...Object(s["b"])("plexservers",["FETCH_AND_SET_RANDOM_BACKGROUND_IMAGE"]),...Object(s["d"])("plex",["SET_PLEX_AUTH_TOKEN"]),async regularAuth(){await this.fetchInitialAuthCode()},async cookieAuth(t){this.loading=!0,this.SET_PLEX_AUTH_TOKEN(t);try{await this.FETCH_PLEX_USER(),await this.postAuth(),this.loading=!1}catch(e){console.error(e),this.SET_PLEX_AUTH_TOKEN(null),await this.regularAuth()}},async fetchInitialAuthCode(){this.loading=!0,this.cancelToken=new c.a.cancelToken,this.plexAuthResponse=await this.FETCH_PLEX_INIT_AUTH(this.cancelToken.signal),this.cancelToken=null,this.loading=!1},async authenticate(){this.loading=!0,this.cancelToken=new c.a.cancelToken,await this.plexAuthChecker(this.cancelToken.signal),await this.postAuth(),this.loading=!1},redirect(){this.$router.push(this.$route.query.redirect||"/")},async postAuth(){this.redirect(),await this.FETCH_PLEX_DEVICES_IF_NEEDED(),await this.FETCH_AND_SET_RANDOM_BACKGROUND_IMAGE()},plexAuthChecker:c()((function*(t){while(1){yield c.a.delay(t,this.GET_CONFIG.plex_auth_check_interval);const e=yield this.isAuthComplete(t);if(e)return}})),async isAuthComplete(t){try{return await this.REQUEST_PLEX_AUTH_TOKEN({signal:t,id:this.plexAuthResponse.id}),!0}catch{return!1}}}},_=o,E=a("2877"),T=a("6544"),u=a.n(T),d=a("0798"),A=a("8336"),p=a("b0af"),U=a("99d9"),C=a("62ad"),g=a("a523"),w=a("adda"),I=a("0fd9"),H=Object(E["a"])(_,i,n,!1,null,null,null);e["default"]=H.exports;u()(H,{VAlert:d["a"],VBtn:A["a"],VCard:p["a"],VCardActions:U["a"],VCardTitle:U["d"],VCol:C["a"],VContainer:g["a"],VImg:w["a"],VRow:I["a"]})}}]);
//# sourceMappingURL=chunk-2d0c8842.8575d0ae.js.map